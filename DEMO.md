# SRT字幕编辑器 - 功能演示

## 主界面

主界面采用简洁的表格视图，清晰显示所有字幕信息：

- **序号列**：字幕编号
- **开始时间列**：字幕开始显示的时间（HH:MM:SS,mmm格式）
- **结束时间列**：字幕结束显示的时间
- **字幕文本列**：字幕内容（支持多行文本）

### 功能特点
- ✅ 可以直接在表格中编辑任何单元格
- ✅ 交替行颜色，易于阅读
- ✅ 窗口标题显示当前文件名和修改状态（*表示未保存）
- ✅ 状态栏提示操作结果

---

## 时间平移功能

**使用场景**：所有字幕整体偏快或偏慢

### 对话框界面
- 输入框：输入时间偏移量（毫秒）
- 正数：字幕向后延迟
- 负数：字幕向前提前
- 提示文字说明使用方法

### 示例
```
输入 +2000：所有字幕延迟2秒
输入 -1500：所有字幕提前1.5秒
```

---

## 点同步功能（核心特性）

### 对话框布局

```
┌─────────────────────────────────────────────────────────────┐
│  选择左侧（当前）和右侧（参考）字幕中应该同步的点...         │
├─────────────────┬─────────────────┬─────────────────────────┤
│  当前字幕（源）  │    同步点列表    │  参考字幕 [加载...]     │
│                 │                 │                         │
│  序号 | 时间 | 文本│  点1: [1]→[2]   │  序号 | 时间 | 文本    │
│  ─────────────  │  点2: [5]→[6]   │  ─────────────────      │
│  1  | 00:00:01 | │  点3: [10]→[11] │  1  | 00:00:02 |       │
│  2  | 00:00:04 | │                 │  2  | 00:00:05 | [深蓝] │
│  3  | 00:00:07 | │  [添加同步点→]  │  3  | 00:00:09 | [中蓝] │
│  4  | 00:00:11 | │  [移除选中]     │  4  | 00:00:14 | [浅蓝] │
│  5  | 00:00:15 | │                 │  5  | 00:00:19 |       │
│  ...            │                 │  ...                    │
│                 │                 │                         │
└─────────────────┴─────────────────┴─────────────────────────┘
    [重置]               [应用预览]  [完成]  [取消]
```

### 界面元素说明

#### 左侧表格（当前字幕）
- 显示当前打开的字幕
- 只读，无法编辑
- 单行选择模式
- 选中一行后，右侧会自动高亮相近时间的字幕

#### 中间同步点列表
- 显示所有已添加的同步点
- 格式：`点N: [源序号] 源时间 ↔ [参考序号] 参考时间`
- 双击可以快速定位到对应的字幕行
- 按源时间自动排序

#### 右侧表格（参考字幕）
- 需要点击"加载参考字幕..."按钮加载
- 只读，无法编辑
- 单行选择模式
- **智能高亮显示**：
  - 深蓝色背景 = 时间非常接近（推荐）
  - 浅蓝色背景 = 时间较接近
  - 白色背景 = 时间差异大

#### 底部按钮
- **重置 (Reset)**：恢复到原始字幕状态，清除所有预览效果
- **应用预览 (Apply)**：计算并显示同步效果，但不退出对话框
- **完成 (Finish)**：确认同步并返回主窗口
- **取消**：放弃所有更改，返回主窗口

---

## 智能高亮演示

### 场景：选择左侧字幕序号5（时间00:00:15）

右侧参考字幕显示效果：

```
序号  时间         文本                  背景色
─────────────────────────────────────────────
1    00:00:02    First subtitle        白色
2    00:00:05    Second subtitle       白色
3    00:00:09    Third subtitle        白色
4    00:00:14    Fourth subtitle       浅蓝色 ⬅ 时间差1秒
5    00:00:19    Fifth subtitle        深蓝色 ⬅ 时间差4秒（最接近）
6    00:00:25    Sixth subtitle        中蓝色 ⬅ 时间差10秒
```

高亮颜色的alpha值根据时间差动态计算：
- 时间差越小，颜色越深
- 超过10秒的不高亮

---

## 操作流程演示

### 步骤1：打开主字幕
```
菜单：文件 > 打开 (Ctrl+O)
选择：test_sample.srt
结果：主界面显示6条中文字幕
```

### 步骤2：启动点同步
```
菜单：编辑 > 点同步 (Ctrl+P)
结果：打开点同步对话框
```

### 步骤3：加载参考字幕
```
操作：点击"加载参考字幕..."按钮
选择：reference_sample.srt
结果：右侧表格显示6条英文字幕
```

### 步骤4：添加第一个同步点
```
操作：
1. 左侧点击第1行（00:00:01,000）
2. 右侧自动高亮，发现第1行（00:00:02,500）最接近
3. 点击右侧第1行选中
4. 点击"添加同步点 →"按钮

结果：中间列表显示
      点1: [1] 00:00:01,000 ↔ [1] 00:00:02,500
```

### 步骤5：添加第二个同步点
```
操作：
1. 左侧点击第6行（00:00:20,000）
2. 右侧自动高亮，发现第6行（00:00:25,000）最接近
3. 点击右侧第6行选中
4. 点击"添加同步点 →"按钮

结果：中间列表显示
      点1: [1] 00:00:01,000 ↔ [1] 00:00:02,500
      点2: [6] 00:00:20,000 ↔ [6] 00:00:25,000
```

### 步骤6：应用预览
```
操作：点击"应用预览 (Apply)"按钮
结果：
- 对话框保持打开
- 左侧表格时间立即更新显示同步后的效果
- 弹出提示："已应用2个同步点的分段线性变换..."
- "重置"和"完成"按钮变为可用
```

### 步骤7：查看效果（可选）
```
操作：滚动查看左侧表格
结果：
- 第1行：00:00:02,500（已同步）
- 第2-5行：按比例调整
- 第6行：00:00:25,000（已同步）

如果不满意：
- 添加/删除同步点
- 再次点击"应用预览"
- 或点击"重置"重新开始
```

### 步骤8：完成同步
```
操作：点击"完成 (Finish)"按钮
结果：
- 对话框关闭
- 主界面字幕时间已更新
- 状态栏显示"已应用点同步"
- 窗口标题显示 * 标记（未保存）
```

### 步骤9：保存文件
```
菜单：文件 > 保存 (Ctrl+S)
结果：字幕保存，* 标记消失
```

---

## 同步效果对比

### 同步前（test_sample.srt）
```
1
00:00:01,000 --> 00:00:03,500
这是第一条字幕

6
00:00:20,000 --> 00:00:23,000
第六条字幕
```

### 同步后
```
1
00:00:02,500 --> 00:00:05,000    ⬅ 延迟1.5秒
这是第一条字幕

6
00:00:25,000 --> 00:00:28,000    ⬅ 延迟5秒
第六条字幕
```

中间的字幕会根据位置线性插值调整。

---

## 高级用法

### 多点同步（3+个点）

适用于复杂的非线性时间偏移：

```
点1: [1]  00:00:01 ↔ 00:00:02    (+1秒偏移)
点2: [10] 00:00:50 ↔ 00:00:52    (+2秒偏移)  ⬅ 中间加快
点3: [20] 00:01:30 ↔ 00:01:33    (+3秒偏移)  ⬅ 持续加快
点4: [30] 00:02:00 ↔ 00:02:02    (+2秒偏移)  ⬅ 又减慢
```

每两个点之间独立计算缩放比例，实现精确同步。

---

## 键盘快捷键

| 功能 | 快捷键 | 说明 |
|------|--------|------|
| 打开文件 | Ctrl+O | 打开SRT文件 |
| 保存 | Ctrl+S | 保存到当前文件 |
| 另存为 | Ctrl+Shift+S | 保存到新文件 |
| 时间平移 | Ctrl+T | 整体时间偏移 |
| 点同步 | Ctrl+P | 通过参考字幕同步 |
| 退出 | Ctrl+Q | 关闭程序 |

---

## 技术亮点

### 1. 分段线性变换算法
- 每两个同步点之间独立计算时间缩放
- 适应非线性的时间变化
- 保持字幕持续时长不变

### 2. 智能时间匹配
- 实时计算左右字幕的时间差
- 动态颜色编码（alpha值计算）
- 10秒阈值过滤

### 3. 用户体验优化
- 双表格对照视图
- 中间同步点管理器
- 双击快速定位
- **实时预览**：点击Apply立即在左侧表格查看效果
- **可重复调整**：应用后可继续修改同步点
- **重置功能**：一键恢复原始状态

### 4. 数据完整性
- 只读表格防止误操作
- 同步点自动排序
- 重复检测（同一源字幕不能有多个同步点）
- 应用前验证（至少2个点）
- 基于原始数据计算，避免累积误差

---

## 系统要求

- **操作系统**：macOS, Linux, Windows
- **Qt版本**：Qt 5.x 或 Qt 6.x
- **编译器**：支持C++17的编译器
- **内存**：至少512MB可用内存
- **存储**：应用程序约5-10MB

---

## 未来改进方向

1. ✨ 支持更多字幕格式（ASS, SSA, VTT等）
2. ✨ 实时预览视频与字幕对齐
3. ✨ 波形图可视化时间轴
4. ✨ 批量处理多个字幕文件
5. ✨ 撤销/重做功能
6. ✨ 字幕合并和拆分
7. ✨ 导出调整报告

---

## 结语

这是一个功能完整、易于使用的SRT字幕编辑器。点同步功能采用专业的算法，可以处理各种复杂的字幕时间同步问题，是视频字幕制作的得力助手。
